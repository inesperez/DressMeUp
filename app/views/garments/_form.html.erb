<div data-controller="camera" data-camera-edit-value="<%= garment.persisted? %>" class="form-upload">
  <%= link_to "Upload a photo", "#", :class => "btn btn-primary", data: {action: "click->camera#fireUpload", camera_target: "uploadButton"} %>
  <%= link_to "Take a photo", "#", :class => "btn btn-primary", data: {action: "click->camera#fireCamera", camera_target: "cameraButton"} %>

  <div data-camera-target="upload" class="d-none">
    <%= simple_form_for garment do |f| %>
      <div>
        <%= f.input :ai_description, placeholder: 'AI Description', as: :hidden %>
        <%= f.input :photo, as: :file, input_html: { data: { camera_target: "input"} } %>
      </div>
      <% if garment.photo.attached? %>
      <p>Existing:</p>
        <%= cl_image_tag garment.photo.key, class: ''%>
    <% end %>
  </div>


    <div class="camera-container d-none" data-camera-target="cameraContainer">
      <canvas id="canvas" data-camera-target="canvas"></canvas>
      <div class="output">
        <img id="photo" alt="The screen capture will appear in this box."
             data-camera-target="preview"/>
      </div>

      <video id="video"
             data-camera-target="video"
             data-action="canplay->camera#resizeVideos">
        Video stream not available.
      </video>
      <button id="startbutton" data-camera-target="pictureButton" data-action="click->camera#takePicture">Take photo</button>
      <button class="d-none" data-camera-target="retakeButton" data-action="click->camera#clearPicture">Retake</button>
    </div>

    <%= f.button :submit, "Add to my wardrobe", class: "btn btn-primary d-none", data: {camera_target: "addGarment"}%>
  <% end %>
</div>
